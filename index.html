<meta charset="UTF-8">

<!-- The speech -->
<script src="speech.js"></script>

<script type="text/javascript">

	function writeToDocument(str) {
		document.write(str + "<br>")
	}

	// Extract all the words
	const words = fulltext.toLowerCase().split(/[ !"\#$%&'()*+,\-./:;<=>?@\[\\\]^_`{|}~â€”]+/)

	const sentences = fulltext.toLowerCase().split(/[!-.;?] /)
	writeToDocument("Sentences " + sentences.length)

	// Create associative array and count word frequency
	var unique = []

	// Check if entry exists, create if not, increment if so
	for (var i in words) {

		const w = words[i]

		var found = -1

		for (var j in unique) {

			if (unique[j].word == w) {

				found = j
				break
			}
		}

		// Increment if word exists, otherwise add it
		found === -1
			? unique.push({ word: w, count: 1 })
			: ++unique[j].count
	}

	unique.sort(function(a, b) { return b.count - a.count })

	writeToDocument("Total words " + words.length)
	writeToDocument("Unique words " + unique.length)

	// Print the most common
	for (var i = 0; i < 40 && i < unique.length; ++i)
		document.write(i + 1 + ": \t" + unique[i].word + "<br>")

	// Periodically reload the page
	setInterval(function() {

		if (window.location.href.split("?").pop() === "reload")
			window.location.reload()
	}, 1000)

</script>
